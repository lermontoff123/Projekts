Задачи:
1.	Очистка и подготовка данных. Проверить данные на пропущенные и аномальные значения (например, отрицательные суммы транзакций). Удалить или исправить некорректные данные. Привести формат дат к единому стандарту.

Загрузили данные и ознакомились с содержимым с помощью библиотеки ProfileReport.
Т.к. признак transaction_id не несёт в себе практического смысла и имеет достаточно много пропущенных значений, удаляем его.
Признак client_id будет использоваться нами для соединения с датасетом clients_data. Поэтому, пока, отсутствующие строки удалим.
Удалили строки с отсутствующими значениями признака clients_id. Т.к. значения, которые мы могли бы предположить, могут быть приписаны другим людям.
Ознакомимся с составом признака transaction_date. Создадим колонку с меткой, указывающей, на отличные от нашей маски дат, ячейки. Проверили содержимое ячеек даты с меткой False. Они все заполнены одним значением, поэтому сгенерируем их позже, а пока, заполним их NaN. Из признака transaction_date сделаем признаки с годом, месяцем, днем недели, днем и временем дня(утро, день, вечер, ночь). Так как год одинаковый- удалим признак года. 
Ознакомимся с признаком amount. Так как сумма очень важна и пропущенных значений всего 4,6%, удалим пропущенные значения.
Применим регрессионную модель с настройками по умолчанию для заполнения пустых значений в получившихся признаках дат относительно признака amount.


2.	Анализ данных. Определить топ-5 наиболее популярных услуг по количеству заказов. Рассчитать среднюю сумму транзакций по каждому городу. Определить услугу с наибольшей выручкой (по сумме amount). Вычислить процент транзакций по способам оплаты (наличные, банковский перевод и т. д.). Рассчитать выручку за последний месяц (по сумме amount).

Определим топ-5 наиболее популярных услуг по количеству заказов. Имеем всего 5 подписанных и одну неизвестную.
Но они все представлены примерно одинаковым количеством.
Рассчитаем среднюю сумму транзакций по каждому городу. Все они примерно одинаковы.
Определим услугу с наибольшей выручкой (по сумме amount). Услуга с наибольшей выручкой: Инвестиционное консультирование с выручкой 113071063.45
Вычислим процент транзакций по способам оплаты (наличные, банковский перевод и т. д.). Кредитная карта имеет наибольший процент транзакций, но не сильно больше банковского перевода.
Рассчитаем выручку за последний месяц (по сумме amount). Выручка за последний месяц: 103549291.24


3.	Объединение данных. Объединить транзакции с клиентскими данными (по id). Создать новую колонку с уровнями активов. Провести анализ по уровням активов и определить, какие категории клиентов приносят наибольшую выручку. Категории клиентов по уровню активов: 
a.	Низкий капитал (<100 000)
b.	Средний капитал (100 000 - 1 000 000)
c.	Высокий капитал (>1 000 000)

Для объединения разберем датасет clients_data. Удалим строки, у которых отсутствуют данные в признаке id, т.к. это определяющий для соединения таблиц признак. 
Объединить транзакции с клиентскими данными (по id).
Заменим категориальные данные в признаке gender цифрами для удобства заполнения.
Применим регрессионную модель для заполнения пустых значений признаков age, gender, net_worth основываясь на данных времени и суммы транзакции.
Создадим новую колонку с уровнями активов с помощью функции.
Проведем анализ по уровням активов и определим, какие категории клиентов приносят наибольшую выручку. Наибольшую выручку приносят клиенты с высоким капиталом, что ожидаемо.


4.	Визуализация данных (* дополнительное задание). Построить распределение сумм транзакций. Создать диаграмму выручки по услугам. Построить график зависимости средней суммы транзакции от возраста клиентов.

Построим распределение сумм транзакций. Наглядно видно, что транзакции с малыми суммами проводятся чаще.
Создадим диаграмму выручки по услугам. Выручка по услугам распределена примерно равномерно.
Построим график зависимости средней суммы транзакции от возраста клиентов. Больше всего тратят клиенты в возрасте от 40 до 45 лет.


5.	Прогнозирование (* дополнительное задание). Прогнозирование спроса на следующий месяц (например, с использованием линейной регрессии).

Спрогнозируем спрос на следующий месяц с использованием модели линейной регрессии. Для этого сгруппируем данные по месяцам. За признак, который необходимо принять, как Х- возьмём месяц, а за у - сумму трат в этом месяце. Обучим модель на этих данных и проведём предсказание на 4 месяц. Построим график для наглядности.
Прогнозируемый спрос на следующий месяц: 89615210.89. Спрос упадёт.
Для более точного анализа необходимо построить модели с учётом других признаков.